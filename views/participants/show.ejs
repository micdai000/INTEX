<!-- Participant Details -->
<section class="py-8">
  <div class="container px-4 md:px-6">
    <div class="mb-6">
      <a href="/participants" class="text-sm text-ella-coral hover:underline">&larr; Back to Participants</a>
    </div>

    <div class="grid md:grid-cols-3 gap-6">
      <!-- Main Info -->
      <div class="md:col-span-2">
        <div class="card">
          <div class="card-header flex justify-between items-center">
            <h1 class="text-2xl font-serif"><%= participant.first_name %> <%= participant.last_name %></h1>
            <% if (isManager) { %>
              <div class="actions">
                <a href="/participants/<%= participant.person_id %>/edit" class="btn-secondary btn-sm">Edit</a>
                <form method="POST" action="/participants/<%= participant.person_id %>/delete" class="inline" onsubmit="return confirm('Are you sure you want to delete this participant?')">
                  <button type="submit" class="btn-danger btn-sm">Delete</button>
                </form>
              </div>
            <% } %>
          </div>
          <div class="card-body">
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <p class="text-sm text-gray-500">Email</p>
                <p class="font-medium"><%= participant.email %></p>
              </div>
              <div>
                <p class="text-sm text-gray-500">Phone</p>
                <p class="font-medium"><%= participant.phone || '-' %></p>
              </div>
              <div>
                <p class="text-sm text-gray-500">Date of Birth</p>
                <p class="font-medium"><%= participant.dob ? new Date(participant.dob).toLocaleDateString() : '-' %></p>
              </div>
              <div>
                <p class="text-sm text-gray-500">Field of Interest</p>
                <p class="font-medium"><%= participant.field_of_interest || '-' %></p>
              </div>
              <div>
                <p class="text-sm text-gray-500">Location</p>
                <p class="font-medium"><%= participant.city ? `${participant.city}, ${participant.state} ${participant.zip || ''}` : '-' %></p>
              </div>
              <div>
                <p class="text-sm text-gray-500">School/Employer</p>
                <p class="font-medium"><%= participant.school_or_employer || '-' %></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Milestones -->
      <div>
        <div class="card">
          <div class="card-header">
            <h2 class="text-lg font-serif">Milestones</h2>
          </div>
          <div class="card-body">
            <% if (milestones.length > 0) { %>
              <div class="milestone-list">
                <% milestones.forEach(m => { %>
                  <div class="milestone-item">
                    <div class="milestone-icon">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                      </svg>
                    </div>
                    <div class="milestone-content">
                      <p class="milestone-title"><%= m.milestone_title %></p>
                      <p class="milestone-date"><%= m.milestone_date ? new Date(m.milestone_date).toLocaleDateString() : 'No date' %></p>
                    </div>
                    <% if (isManager) { %>
                      <form method="POST" action="/participants/<%= participant.person_id %>/milestones/<%= m.milestone_no %>/delete">
                        <button type="submit" class="milestone-remove" onclick="return confirm('Delete this milestone?')" aria-label="Delete milestone">
                          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                          </svg>
                        </button>
                      </form>
                    <% } %>
                  </div>
                <% }); %>
              </div>
            <% } else { %>
              <p class="text-sm text-gray-500 mb-4">No milestones yet.</p>
            <% } %>

            <% if (isManager) { %>
              <!-- Add Milestone Form -->
              <div class="milestone-form">
                <h3 class="milestone-form-title">Add Milestone</h3>
                <form method="POST" action="/participants/<%= participant.person_id %>/milestones" aria-label="Add milestone form">
                  <div class="form-group">
                    <label for="milestone_title" class="form-label">Title</label>
                    <input type="text" id="milestone_title" name="milestone_title" class="form-input" placeholder="e.g., Graduated High School" required aria-required="true">
                  </div>
                  <div class="form-group">
                    <label for="milestone_date" class="form-label">Date</label>
                    <input type="date" id="milestone_date" name="milestone_date" class="form-input">
                  </div>
                  <button type="submit" class="btn-primary w-full">Add Milestone</button>
                </form>
              </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
