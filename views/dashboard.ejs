<!-- Dashboard - Clean Modern Design -->
<section class="section dashboard-section">
  <div class="container">
    <!-- Welcome Header -->
    <div class="mb-8 text-center">
      <h1 class="dashboard-title">
        Welcome, <%= user.firstName || 'User' %>!
      </h1>
      <p style="color: var(--ella-gray); font-size: 1.0625rem;">
        <% if (isManager) { %>
          Manager Dashboard - Full access to all features
        <% } else { %>
          View participant data and events
        <% } %>
      </p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid mb-8">
      <a href="/participants" class="stat-card stat-card-link">
        <div class="stat-value"><%= stats.participants %></div>
        <div class="stat-label">Participants</div>
      </a>
      <a href="/events" class="stat-card stat-card-link">
        <div class="stat-value"><%= stats.events %></div>
        <div class="stat-label">Events</div>
      </a>
      <a href="/surveys" class="stat-card stat-card-link">
        <div class="stat-value"><%= stats.registrations %></div>
        <div class="stat-label">Registrations</div>
      </a>
      <a href="/donations" class="stat-card stat-card-link">
        <div class="stat-value"><%= stats.donations %></div>
        <div class="stat-label">Donations</div>
      </a>
    </div>

    <!-- Tableau Dashboard (no title) -->
    <div class="tableau-container mb-8">
      <div class="tableau-scale-wrapper">
      <div class='tableauPlaceholder' id='viz1764790979903' style='position: relative'>
        <noscript>
          <a href='#'>
            <img alt='Dashboard 2' src='https://public.tableau.com/static/images/IN/INTEX_2025_Group3-3/Dashboard2/1_rss.png' style='border: none' />
          </a>
        </noscript>
        <object class='tableauViz' style='display:none;'>
          <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
          <param name='embed_code_version' value='3' />
          <param name='site_root' value='' />
          <param name='name' value='INTEX_2025_Group3-3/Dashboard2' />
          <param name='tabs' value='no' />
          <param name='toolbar' value='yes' />
          <param name='static_image' value='https://public.tableau.com/static/images/IN/INTEX_2025_Group3-3/Dashboard2/1.png' />
          <param name='animate_transition' value='yes' />
          <param name='display_static_image' value='yes' />
          <param name='display_spinner' value='yes' />
          <param name='display_overlay' value='yes' />
          <param name='display_count' value='yes' />
          <param name='language' value='en-US' />
          <param name='filter' value='publish=yes' />
        </object>
      </div>
      </div>
    </div>

  </div>
</section>

<script type='text/javascript'>
  var divElement = document.getElementById('viz1764790979903');
  var vizElement = divElement.getElementsByTagName('object')[0];
  var wrapper = divElement.parentElement;
  var container = wrapper.parentElement;

  // Native Tableau dashboard size - full dashboard dimensions
  var nativeWidth = 1200;
  var nativeHeight = 1200;

  // Set viz to native size
  vizElement.style.width = nativeWidth + 'px';
  vizElement.style.height = nativeHeight + 'px';
  wrapper.style.width = nativeWidth + 'px';
  wrapper.style.height = nativeHeight + 'px';
  wrapper.style.position = 'relative';

  function scaleToFit() {
    // Get available width minus padding
    var availableWidth = container.offsetWidth - 48;
    // Scale based on width - this will scale the whole thing down
    var scale = Math.min(0.75, availableWidth / nativeWidth);

    // Apply scale transform
    wrapper.style.transform = 'scale(' + scale + ')';
    wrapper.style.transformOrigin = 'top left';

    // Center horizontally
    var scaledWidth = nativeWidth * scale;
    var marginLeft = Math.max(0, (availableWidth - scaledWidth) / 2);
    wrapper.style.marginLeft = marginLeft + 'px';

    // Set container height to match scaled size
    container.style.height = (nativeHeight * scale) + 'px';
  }

  scaleToFit();
  window.addEventListener('resize', scaleToFit);

  var scriptElement = document.createElement('script');
  scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
  vizElement.parentNode.insertBefore(scriptElement, vizElement);
</script>
